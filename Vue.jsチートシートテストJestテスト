# ğŸš€ **Vue.js ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ**

## ğŸ“‹ **åŸºæœ¬ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**

```javascript
import { mount, createLocalVue } from '@vue/test-utils' // ãƒ†ã‚¹ãƒˆç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
import Component from '@/components/Component.vue'      // ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
import flushPromises from 'flush-promises'              // éåŒæœŸå‡¦ç†å¾…æ©Ÿ

describe('Component.vue', () => {                        // ãƒ†ã‚¹ãƒˆã‚°ãƒ«ãƒ¼ãƒ—
  let wrapper                                           // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ãƒƒãƒ‘ãƒ¼
  
  beforeEach(() => {                                    // å„ãƒ†ã‚¹ãƒˆå‰å®Ÿè¡Œ
    // å…±é€šã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  })
  
  afterEach(() => {                                     // å„ãƒ†ã‚¹ãƒˆå¾Œå®Ÿè¡Œ
    if (wrapper) wrapper.destroy()                      // ãƒ¡ãƒ¢ãƒªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
    jest.restoreAllMocks()                              // ãƒ¢ãƒƒã‚¯å¾©å…ƒ
  })
  
  it('ãƒ†ã‚¹ãƒˆå', async () => {                          // å€‹åˆ¥ãƒ†ã‚¹ãƒˆ
    // ãƒ†ã‚¹ãƒˆå†…å®¹
  })
})
```

---

## ğŸ¯ **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆ**

```javascript
// âœ… åŸºæœ¬ãƒã‚¦ãƒ³ãƒˆ
const wrapper = mount(Component, {                      // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’DOMã«ãƒã‚¦ãƒ³ãƒˆ
  propsData: { prop1: 'value' },                       // è¦ªã‹ã‚‰æ¸¡ã™ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
  mocks: { $store: mockStore },                        // Vue ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ¢ãƒƒã‚¯
  components: { Modal: MockModal }                     // å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ¢ãƒƒã‚¯
})

// âœ… LocalVueä½¿ç”¨
const localVue = createLocalVue()                      // ç‹¬ç«‹ã—ãŸVueã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
const wrapper = mount(Component, { localVue })         // éš”é›¢ç’°å¢ƒã§ãƒã‚¦ãƒ³ãƒˆ
```

---

## ğŸ”§ **ãƒ¢ãƒƒã‚¯ä½œæˆãƒ‘ã‚¿ãƒ¼ãƒ³**

### **åŸºæœ¬ãƒ¢ãƒƒã‚¯**
```javascript
const mockFn = jest.fn()                               // ç©ºã®ãƒ¢ãƒƒã‚¯é–¢æ•°
const mockFnWithReturn = jest.fn().mockReturnValue(42) // æˆ»ã‚Šå€¤ä»˜ããƒ¢ãƒƒã‚¯
const mockFnAsync = jest.fn().mockResolvedValue(data)  // éåŒæœŸãƒ¢ãƒƒã‚¯(æˆåŠŸ)
const mockFnError = jest.fn().mockRejectedValue(error) // éåŒæœŸãƒ¢ãƒƒã‚¯(å¤±æ•—)
```

### **ãƒ¡ã‚½ãƒƒãƒ‰ãƒ¢ãƒƒã‚¯**
```javascript
wrapper.vm.methodName = jest.fn()                      // ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒ¢ãƒƒã‚¯åŒ–
jest.spyOn(wrapper.vm, 'methodName')                   // ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç›£è¦–
wrapper.vm.methodName.mockReturnValue(100)             // æˆ»ã‚Šå€¤è¨­å®š
```

### **Vuexã‚¹ãƒˆã‚¢ãƒ¢ãƒƒã‚¯**
```javascript
const mockStore = {                                    // ã‚¹ãƒˆã‚¢ã®å½ç‰©
  getters: {                                           // gettersã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
    'module/getter': jest.fn().mockReturnValue(true)   // getteré–¢æ•°ã®ãƒ¢ãƒƒã‚¯
  },
  dispatch: jest.fn(),                                 // actionå®Ÿè¡Œã®ãƒ¢ãƒƒã‚¯
  commit: jest.fn()                                    // mutationå®Ÿè¡Œã®ãƒ¢ãƒƒã‚¯
}
```

### **DOMè¦ç´ ãƒ¢ãƒƒã‚¯**
```javascript
const mockElements = {                                 // å½ã®DOMè¦ç´ 
  elementId: {                                         // è¦ç´ ID
    style: { height: '0px' },                         // ã‚¹ã‚¿ã‚¤ãƒ«ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
    clientHeight: 100                                  // é«˜ã•ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
  }
}
jest.spyOn(document, 'getElementById')                 // DOMæ¤œç´¢ãƒ¡ã‚½ãƒƒãƒ‰ç›£è¦–
    .mockImplementation(id => mockElements[id])        // å½è¦ç´ ã‚’è¿”ã™ã‚ˆã†ç½®æ›
```

### **æ—¥ä»˜ãƒ¢ãƒƒã‚¯**
```javascript
const fixedDate = new Date(2019, 9, 1)                // å›ºå®šæ—¥ä»˜ä½œæˆ
const mockDate = jest.spyOn(global, 'Date')           // Dateã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ¼ç›£è¦–
    .mockImplementation(() => fixedDate)               // å¸¸ã«å›ºå®šæ—¥ä»˜ã‚’è¿”ã™
// ãƒ†ã‚¹ãƒˆå¾Œ: mockDate.mockRestore()                   // å…ƒã«æˆ»ã™
```

---

## ğŸ” **DOMæ“ä½œã¨ã‚¤ãƒ™ãƒ³ãƒˆ**

```javascript
// âœ… è¦ç´ æ¤œç´¢
wrapper.find('.class-name')                           // ã‚¯ãƒ©ã‚¹åã§æ¤œç´¢
wrapper.find('#element-id')                           // ID ã§æ¤œç´¢
wrapper.find('select[name="field"]')                  // å±æ€§ã§æ¤œç´¢
wrapper.findAll('option')                             // è¤‡æ•°è¦ç´ æ¤œç´¢

// âœ… è¦ç´ ã®çŠ¶æ…‹ç¢ºèª
wrapper.find('.element').exists()                     // è¦ç´ ãŒå­˜åœ¨ã™ã‚‹ã‹
wrapper.find('.element').isVisible()                  // è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹
wrapper.find('select').attributes().disabled          // disabledå±æ€§ã®ç¢ºèª

// âœ… è¦ç´ ã®å€¤å–å¾—
wrapper.find('.text').text()                          // ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹å–å¾—
wrapper.find('input').element.value                   // inputè¦ç´ ã®å€¤
wrapper.find('select').element.selectedIndex          // selectè¦ç´ ã®é¸æŠã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

// âœ… ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«
wrapper.find('button').trigger('click')               // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«
wrapper.find('select').setValue('3')                  // selectè¦ç´ ã®å€¤è¨­å®š
wrapper.find('input').setChecked(true)                // checkbox/radioã®è¨­å®š
```

---

## â±ï¸ **éåŒæœŸå‡¦ç†**

```javascript
// âœ… DOMæ›´æ–°å¾…æ©Ÿ
await wrapper.vm.$nextTick()                          // æ¬¡ã®DOMæ›´æ–°ã¾ã§å¾…æ©Ÿ

// âœ… å…¨Promiseå®Œäº†å¾…æ©Ÿ
await flushPromises()                                  // å…¨ã¦ã®éåŒæœŸå‡¦ç†å®Œäº†ã¾ã§å¾…æ©Ÿ

// âœ… ã‚¿ã‚¤ãƒãƒ¼ãƒ¢ãƒƒã‚¯
jest.useFakeTimers()                                   // å½ã®ã‚¿ã‚¤ãƒãƒ¼ä½¿ç”¨
jest.advanceTimersByTime(5000)                        // 5ç§’é€²ã‚ã‚‹
jest.useRealTimers()                                   // å®Ÿéš›ã®ã‚¿ã‚¤ãƒãƒ¼ã«æˆ»ã™
```

---

## âœ… **ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ¤œè¨¼ï¼‰**

### **åŸºæœ¬æ¤œè¨¼**
```javascript
expect(value).toBe(expected)                          // å³å¯†ç­‰ä¾¡æ¯”è¼ƒ
expect(value).toEqual(expected)                       // æ·±ã„ç­‰ä¾¡æ¯”è¼ƒ
expect(value).not.toBe(unexpected)                    // å¦å®š
expect(array).toHaveLength(3)                         // é…åˆ—é•·ã•
expect(string).toMatch(/pattern/)                     // æ­£è¦è¡¨ç¾ãƒãƒƒãƒ
```

### **DOMæ¤œè¨¼**
```javascript
expect(wrapper.find('.class').exists()).toBe(true)    // è¦ç´ å­˜åœ¨ç¢ºèª
expect(wrapper.find('.text').text()).toBe('hello')    // ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹ç¢ºèª
expect(wrapper.findAll('li')).toHaveLength(5)         // è¦ç´ æ•°ç¢ºèª
```

### **é–¢æ•°å‘¼ã³å‡ºã—æ¤œè¨¼**
```javascript
expect(mockFn).toHaveBeenCalled()                     // å‘¼ã³å‡ºã•ã‚ŒãŸ
expect(mockFn).toHaveBeenCalledTimes(2)               // 2å›å‘¼ã³å‡ºã•ã‚ŒãŸ
expect(mockFn).toHaveBeenCalledWith(arg1, arg2)       // å¼•æ•°ä»˜ãã§å‘¼ã³å‡ºã•ã‚ŒãŸ
expect(mockFn).not.toHaveBeenCalled()                 // å‘¼ã³å‡ºã•ã‚Œã¦ã„ãªã„
```

---

## ğŸ¨ **å®Ÿç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ**

### **åŸºæœ¬è¡¨ç¤ºãƒ†ã‚¹ãƒˆ**
```javascript
it('æ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹', () => {
  const wrapper = mount(Component, {                   // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆ
    propsData: { title: 'Test' }                      // propsè¨­å®š
  })
  expect(wrapper.find('h1').text()).toBe('Test')      // è¡¨ç¤ºå†…å®¹ç¢ºèª
})
```

### **ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³å¤‰æ›´ãƒ†ã‚¹ãƒˆ**
```javascript
it('é¸æŠå¤‰æ›´ã§å€¤ãŒæ›´æ–°ã•ã‚Œã‚‹', async () => {
  const wrapper = mount(Component)                     // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆ
  const spy = jest.spyOn(wrapper.vm, 'onChange')      // ãƒ¡ã‚½ãƒƒãƒ‰ç›£è¦–
  
  await wrapper.find('select').setValue('2')          // å€¤å¤‰æ›´
  await wrapper.vm.$nextTick()                        // DOMæ›´æ–°å¾…æ©Ÿ
  
  expect(spy).toHaveBeenCalled()                      // ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ç¢ºèª
})
```

### **ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºãƒ†ã‚¹ãƒˆ**
```javascript
it('ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤º', async () => {
  const wrapper = mount(Component)                     // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆ
  
  await wrapper.find('.help-button').trigger('click') // ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
  await wrapper.vm.$nextTick()                        // DOMæ›´æ–°å¾…æ©Ÿ
  
  expect(wrapper.find('.modal').exists()).toBe(true)  // ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºç¢ºèª
})
```

### **å¹´é½¢åˆ¶é™ãƒ†ã‚¹ãƒˆ**
```javascript
it('å¹´é½¢ã«ã‚ˆã‚Šè¡¨ç¤ºåˆ¶å¾¡ã•ã‚Œã‚‹', () => {
  const wrapper = mount(Component, {                   // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆ
    propsData: { 
      application: { fullAge: 81 }                    // 81æ­³è¨­å®š
    }
  })
  expect(wrapper.find('select').exists()).toBe(false) // è¦ç´ éè¡¨ç¤ºç¢ºèª
  expect(wrapper.find('p').text())                    // ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç¢ºèª
    .toBe('ãŠå®¢æ§˜ã®ã”å¥‘ç´„å¹´é½¢ã§ã¯ã€ãŠå–ã‚Šæ‰±ã„ã§ãã¾ã›ã‚“ã€‚')
})
```

---

## ğŸš¨ **ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•**

```javascript
// âŒ ã‚¨ãƒ©ãƒ¼: Cannot read property 'xxx' of undefined
// âœ… å¯¾å‡¦: propsData ã§å¿…è¦ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™
const wrapper = mount(Component, {
  propsData: { application: { fullAge: 20 } }         // å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®š
})

// âŒ ã‚¨ãƒ©ãƒ¼: [Vue warn] Unknown custom element
// âœ… å¯¾å‡¦: å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¢ãƒƒã‚¯åŒ–
const wrapper = mount(Component, {
  components: { ChildComponent: { template: '<div/>' } } // å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ¢ãƒƒã‚¯
})

// âŒ ã‚¨ãƒ©ãƒ¼: TypeError: Cannot read property 'getElementById'
// âœ… å¯¾å‡¦: DOMè¦ç´ ã‚’ãƒ¢ãƒƒã‚¯åŒ–
jest.spyOn(document, 'getElementById')                 // DOM ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ¢ãƒƒã‚¯
    .mockReturnValue({ style: {} })                   // å½è¦ç´ ã‚’è¿”ã™
```

---

## ğŸ“ **ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

```javascript
afterEach(() => {
  if (wrapper) wrapper.destroy()                      // âœ… ãƒ©ãƒƒãƒ‘ãƒ¼ç ´æ£„
  jest.restoreAllMocks()                              // âœ… ãƒ¢ãƒƒã‚¯å¾©å…ƒ
  jest.clearAllMocks()                                // âœ… ãƒ¢ãƒƒã‚¯å±¥æ­´ã‚¯ãƒªã‚¢
  jest.useRealTimers()                                // âœ… ã‚¿ã‚¤ãƒãƒ¼å¾©å…ƒ
})
```

ã“ã®ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆãŒã‚ã‚Œã°ã€Vue.jsãƒ†ã‚¹ãƒˆã®90%ã¯æ›¸ã‘ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼
